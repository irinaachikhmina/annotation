# annotation
Задача: аннотировать фрагмент генома бактерии и как можно точнее определить таксон, к которому бактерия принадлежит.

## Информация о фрагменте
ID - 13/1-69936  
Длина фрагмента - 69,936 нт

## Открытые рамки считывания
Программа: Artemis  
	Определение ORF  
o	параметр minimal ORF – 150  
	Сдвиг к старт-кодонам  
o	Trim selected features – to all  
Ожидание: ~55 ORF с учетом среднего соотношения размера генома и количества открытых рамок считывания у бактерий  
Результаты: 52 ORF  

## Поиск генов и тРНК
Программы: Blast, обработка данных в Python  
ШАГ1 – Поиск генов в BLASTP  
	Organism – bacteria (taxid:2)  
	База SwissProt  
o	Параметры по умолчанию, только бактерии  
o	5 значимых находок с идентичностью более 95%  
o	Для остальных фрагментов либо нет находок (8), либо нет хороших находок (39) -  хорошие показатели покрытия и e-value; процент идентичности чаще всего низкий - 30-40%, similarity - 66% и ниже  
	База RefSeq  
o	меньшее количество Max target sequences (10), в остальном параметры по умолчанию, только бактерии  
o	Для всех OFR кроме двух есть находки: хорошие показатели покрытия (>80%), e-value (<0.01), процента идентичности (лучшие находки >98.7%)  
o	ORF00030 – нет находок  
o	ORF00051c – 1 находка с низким identity (45%)  
	Non-redundant protein sequences  
o	Для фрагментов, не аннjтированных по SwissProt и RefSeq  
o	Параметры по умолчанию, только бактерии  
o	Для 1 фрагмента (ORF00051c) нашлись близкие последовательности со схожестью более 95%.  
o	Для 1 фрагмента (ORF00030) нашлись последовательности с процентом идентичности около 70%, но низким cover rate. Данная последовательность полностью накладывается на предыдущий фрагмент (ORF00029), поэтому она была исключена из аннотации (см. ШАГ 4).  
	Обработка результатов в Python (см. скрипт, раздел Genes – ORFs):  
o	для каждого гена, предсказанного BLASTP, были отобраны лучшие по identity результаты. Минимальное значение identity среди отобранных – 97.84%  
o	отобранные гены (51) были записаны в таблицу результатов  
o	также в таблицу были записаны координаты генов  
Результаты:  
	5 ORF – результат поиска в SwissProt  
	45 ORF – результат поиска в RefSeq  
	1 ORF – результат поиска NR  
1 ORF был исключен из дальнейшего анализа из-за наложения на ранее аннотированные фрагменты с более высокими параметрами.  

ШАГ2 – Поиск тРНК
tRNAscan, описание шагов и параметров:  
	Для бактериальных последовательностей  
	Настройки поиска по умолчанию и поиск “Infernal without HMM filter”  
Результаты: нет  
 
Aragorn, описание шагов и параметров:  
	Поиск и tRNA, tmRNA  
	Кольцевая топология  
Результаты: нет  
 
ШАГ3 – Поиск в межгенных участках  
Программы: Artemis, BLAST  
Описание шагов и параметров:  
	С помощью Artemis были получены межгенные участки (Create->intergenic features). Фрагменты были скачены в виде протеиновых (для BLASTP) и нуклеотидных (для TBLASTX) последовательностей.  
	BLASTP - Non-redundant protein sequences – бактерии  
o	находки для 4 фрагментов с хорошими показателями идентичности  
o	среди результатов было выбрано по одному самому лучшему результату (по показателю идентичности) – см. скрипт Python, раздел Genes-Intergenic  
o	на основе выравнивания с лучшим результатом были определены координаты гена в аннотируемом фрагменте и скорректированы координаты фрагментов. Например, для 1 фрагмента PORF00001:  
	лучшая находка - hypothetical protein D039_2310 (ETY10707.1)  
 	обрезаем межгенный фрагмент до и после совпадения в выравнивании (до 1 и после 42 позиций)  
o	fasta файл со скорректированными координатами отправляем в BLASTP  
	TBLASTX - Non-redundant protein sequences – Genetic code 11 (bacteria and archaea)  
	Обработка результатов в Python (см. скрипт, раздел Genes – Intergenic):  
o	отобранные гены (4) были записаны в таблицу результатов. Минимальное значение identity среди отобранных – 96.67%  
o	также в таблицу были записаны координаты генов  
Результаты:  
	4 гена, не аннотированных ранее  

ШАГ4 – Проверка пересечений/ наложений аннотированных генов  
Программы: Python  
Описание шагов и параметров:  
	Предполагалось исключить полные наложения и пересечения более 50 нуклеотидов.  
	Наложения и пересечения считались в Python (см. раздел Overlap)  
Результаты:  
	Наложения – 1 наложение, которые было исключено на Шаге 1  
	Пересечения – есть, но в допустимых пределах (3-37 нк)  

ШАГ5 – Поиск функций гипотетических белков  
Использовался Python, InterPro, Pfam, BLAST  
Описание шагов, параметров, результатов:  
	Для белков с неизвестным функциями была предпринята попытка уточнить их функцию либо семейство. Для этого использовались базы InterPro, Pfam (параметры по умолчанию и с учетом таксономии), поиск ортологов в BLAST.  
	InterPro: для 1 из 6 гипотетических белков была определена функция.  
	Pfam: для 0 из 6 гипотетических белков была определена функция. Использовались данные только существенных соответствий (Significant Pfam-A Matches) и с учетом таксономии. Несущественные соответствия в расчет не брались (по ним, в частности, не совпала таксономия).  
	Поиск ортологов с помощью BLAST: для 3 гипотетических белков была определена функция, использовался BLASTP с повышенным порогом по e-value, отбирались белки с cover rate и identity свыше 60%.  
	В таблицу с аннотированными генами была добавлена информация о функции белков, по которым удалось их уточнить.  

## Сравнение c автоматической аннотацией	Использовался RAST  
Описание шагов, параметров, результатов:  
	RAST: Бактерии, генетический код 11, в остальном – параметры по умолчанию  
	Сравнение с аннотацией, сделанной с помощью BLAST:  
o	Выборочное сравнение первых 11 генов из ORFов  
![image](https://github.com/irinaachikhmina/annotation/assets/120565496/819ad4c3-e482-4fc0-b71f-f57619e04a69)

Темно-зеленом помечены координаты и функции совпавшие полностью.  
Светло-зеленым помечены координаты и функции, совпавшие примерно:  
	погрешность по координатам в пределах 50 нуклеотидов,  
	функции не совпали для тех генов, функцию которых RAST не определил  
o	IoU  
	IoU был оценен примерно следующим образом:  
•	Intersection = длина генов, аннотированных вручную (в общем и целом соответствуют результатам RAST), деленное на  
•	Union = длина генов, аннотированных RAST  
•	Результат – 99%   
•	Процент соответствует соотношению генов, аннотированных вручную, и генов, аннотированных с помощью RAST (55 из 57).  
Результат и выводы  
Файл GenBank:  
![image](https://github.com/irinaachikhmina/annotation/assets/120565496/c863bf53-e6a7-4fcd-916a-0e6ccd891d94)  
В целом гены внутри открытых рамок считывания (51 ген) аннотировались достаточно точно.  
Аннотацию межгенных участков (4 гена) теоретически можно было бы улучшить, переписав данные из готовой аннотации Vibrio parahaemolyticus, chromosome 2, так как из результатов TBLASTX было очевидно, что аннотируемый фрагмент – это фрагмент генома именно этой бактерии.  

## Citations:
1.	Artemis: an integrated platform for visualization and analysis of high-throughput sequence-based experimental data. Carver T, Harris SR, Berriman M, Parkhill J and McQuillan JA. Bioinformatics (Oxford, England) 2012;28;4;464-9. PUBMED: 22199388; PMC: 3278759; DOI: 10.1093/bioinformatics/btr703
2.	BedTools: Quinlan AR and Hall IM, 2010. BEDTools: a flexible suite of utilities for comparing genomic features. Bioinformatics. 26, 6, pp. 841–842.
3.	BLAST: Madden T. The BLAST Sequence Analysis Tool. 2002 Oct 9 [Updated 2003 Aug 13]. In: McEntyre J, Ostell J, editors. The NCBI Handbook [Internet]. Bethesda (MD): National Center for Biotechnology Information (US); 2002-. Chapter 16.
4.	tRNAscan-SE On-line: Lowe, T.M. and Chan, P.P. (2016) tRNAscan-SE On-line: Search and Contextual Analysis of Transfer RNA Genes. Nucl. Acids Res. 44:W54-57.
5.	InterPro (RRID:SCR_006695)
6.	Pfam: The protein families database in 2021: J. Mistry, S. Chuguransky, L. Williams, M. Qureshi, G.A. Salazar, E.L.L. Sonnhammer, S.C.E. Tosatto, L. Paladin, S. Raj, L.J. Richardson, R.D. Finn, A. Bateman. Nucleic Acids Research (2020) doi: 10.1093/nar/gkaa913
7.	The RAST Server: Rapid Annotations using Subsystems Technology. Aziz RK, Bartels D, Best AA, DeJongh M, Disz T, Edwards RA, Formsma K, Gerdes S, Glass EM, Kubal M, Meyer F, Olsen GJ, Olson R, Osterman AL, Overbeek RA, McNeil LK, Paarmann D, Paczian T, Parrello B, Pusch GD, Reich C, Stevens R, Vassieva O, Vonstein V, Wilke A, Zagnitko O. BMC Genomics, 2008, [ PubMed entry ]
